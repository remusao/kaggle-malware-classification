#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
Usage:
    submit <test_dir> <predictions.hdf5> <labels.txt>
    submit -h | --help

Options:
    -h, --help      Show help
"""


from __future__ import print_function
import docopt
import h5py
import pandas
import utils

header = ["Id", "Prediction1", "Prediction2", "Prediction3", "Prediction4", "Prediction5", "Prediction6", "Prediction7", "Prediction8", "Prediction9"]

def main():
    args = docopt.docopt(__doc__)

    print("Load predictions")
    with open(args['<labels.txt>'], 'r') as labels_file:
        print("Load labels")
        labels = labels_file.read().split()
        with h5py.File(args['<predictions.hdf5>'], 'r') as predictions:
            y_pred = predictions['Y'].value
            images = predictions['IDS']
            print("Creating resulting CSV")
            df = pandas.DataFrame(y_pred, columns=labels, index=predictions)
            df.index.name = "Id"
            df = df[header]
            print("Dump submission.csv")
            df.to_csv('submission.csv')


if __name__ == "__main__":
    main()


